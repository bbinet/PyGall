<%!
    import os
%>
<%
    dirs = {}
    rows = []
    id = 0
    for path in c.tree:
        id += 1
        row = {}
        row['id'] = id
        row['path'] = path
        row['class'] = "file"
        if path.endswith(os.sep):
            path = path[:-1]
            dirs[path] = id
            row['class'] = "folder"
        parent = os.path.dirname(path)
        row['parent'] = dirs[parent] if dirs.has_key(parent) else None
        rows.append(row)
%>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <title>Import de photos</title>
    <link href="${url('/lib/treeTable/css/jquery.treeTable.css')}" rel="stylesheet" type="text/css" />
    <script src="${url('/js/jquery.min.js')}" type="text/javascript"></script>
    <script src="${url('/lib/treeTable/js/jquery.treeTable.min.js')}" type="text/javascript"></script>
    <script type="text/javascript">
    $(document).ready(function() {
        $("table#photos-tree").treeTable({
            initialState: "expanded"
        });

        // make visible that a row is clicked
        $("table#photos-tree tbody tr").mousedown(function() {
            $("tr.selected").removeClass("selected"); // Deselect currently selected rows
            $(this).addClass("selected");
        });

        // make sure row is selected when span is clicked
        $("table#photos-tree tbody tr span").mousedown(function() {
            $($(this).parents("tr")[0]).trigger("mousedown");
        });
        });
    });
    </script>
</head>
<body>
    <h3>Importer les photos dans la gallerie PyGall</h1>
    <table id="photos-tree">
        <thead>
            <tr>
                <th>Titre</th>
                <th>Importer</th>
                <th>Supprimer</th>
            </tr>
        </thead>
        <tbody>
        % for row in rows:
            % if row['parent'] is None:
            <tr id="node-${row['id']}">
            % else:
            <tr id="node-${row['id']}" class="child-of-node-${row['parent']}">
            % endif
                <td><span class="${row['class']}">${row['path']}</span></td>
                <td>${row['id']} Ko</td>
                <td>Bla bla</td>
            </tr>
        % endfor
        </tbody>
    </table>
</body>
</html>
